---
layout: page

category: "Guides"
category_lead:  "XML Pointers"
title:  "Changes in 1.4.1"

---



<p>PGM protocol 1.4.1 introduced dynamic filters and added several new features.</p>
<p>Dynamic filters trigger the action when the observed value changes. ?Other filters can be used in combination with dynamics, if a dynamic is expected at least one dynamic filter must be used.?</p>
<p>The objectives filter will now automatically derive team ownership for the objective from context.
        To match an objective without any specific team, the <code>any="true"</code> attribute needs to be specified.</p>
<pre><code>[14:15]
cubist oh, another breaking change is that `objective` filters will work the same for all objective types
so, `&lt;objective&gt;` alone will always derive the team from context
and if you want to match the objective without any specific team, you always have to specify `any="true"`
I'm not sure how much that will break.. could be a lot

[14:22]
yoyo_ Does this mean all objectives are now sort of like hills?
I don’t really see this breaking much, only a very small handful of maps used &lt;objective&gt; in the first place.

[14:23]
cubist yes, it means the other objective types work the same as hills now
</code></pre>
<h3>Dynamics</h3>
<p>??? Dynamic:  dynamic filters currently can be used with kits, portals, and structures</p>
<p>with kits, for example, you can do this:
        <code>&lt;kit lend="my-filter"&gt;...&lt;/kit&gt;</code></p>
<p>the kit will be given and taken in sync with the state of the filter, you can also do <code>give</code> and <code>take</code> instead of <code>lend</code></p>
<p>portals have a <code>trigger</code> property that is a filter.. when the filter goes from false to true for any player, they are teleported.. region is not required</p>
<p>[14:30]
        cubist also, <code>&lt;dynamic&gt;</code>s now have a <code>trigger</code> and a <code>filter</code> property as of proto 1.4.2
        <code>trigger</code> does what <code>filter</code> used to do, except it won't let you use any non-dynamic filters like <code>&lt;random&gt;</code>
        but <code>filter</code> can be anything, and it is checked only on the rising edge of <code>trigger</code>
        so this gives you a legit way to do e.g. randomized structures</p>
<p>[14:34]
        yoyo_ What’s the rising edge of trigger?</p>
<p>[14:34]
        cubist when it goes from deny to allow
        <code>trigger</code> defaults to <code>&lt;always/&gt;</code>, so if you just specify <code>filter</code> then it will check that at match load and never again</p>
<p>[14:40]
        yoyo_ Will dynamic filters replace filters, or will the old filters stay as they were?</p>
<p>[14:40]
        cubist it's all backwards compatible aside from the few things I mentioned</p>
<p>[14:44]
        yoyo_ Will objectives be dynamic for the original release? They weren’t included in your original list</p>
<p>[14:44]
        cubist yes, I forgot to include them in the list</p>
<p>[14:45]
        yoyo_ This actually sounds amazing. So I can do a portal that sends people to the destination when a hill is captured instead of when they enter a region?</p>
<p>[14:45]
        cubist yep</p>
<p>[14:46]
        yoyo_ Perfect. Thanks mate</p>
<p>[14:46]
        cubist I'm considering if portals should work in both directions with filters.. so rising edge sends you forward, falling edge sends you backward</p>
<p>[14:47]
        yoyo_ Sounds like it could be an interesting behaviour. Couldn’t you already do that with just two portals and a <not> on the original filter?</not></p>
<p>[14:48]
        cubist yes
        it would just be more convenient as a single portal.. not sure if it matters much though
        the dynamic filter properties for portals are <code>forward</code>, <code>reverse</code>, and <code>transit</code></p>
<h3>Dynamic Portals</h3>
<p>11:16]
        cubist make the region part of the <code>forward</code> filter
        <code>forward</code> - apply forward transform on rising edge
        <code>reverse</code> - apply reverse transform on rising edge
        <code>transit</code> - apply forward transform on rising edge and reverse transform on falling edge</p>
<p>[11:25]
        yoyo_ So, for example, how should I edit this?</p>
<pre><code>&lt;portal forward="red-filter" yaw="@0" sound="false"&gt;
    &lt;region&gt;
        &lt;region id="portal-region"/&gt;
    &lt;/region&gt;
    &lt;destination&gt;
        &lt;region id="arena1-spawn1-round1"/&gt;
    &lt;/destination&gt;
&lt;/portal&gt;
</code></pre>
<p>[11:56]
        cubist</p>
<pre><code>&lt;all id="red-filter"&gt;
    &lt;team&gt;red-team&lt;/team&gt;
    &lt;not&gt;
        &lt;objective any="true"&gt;round1-start&lt;/objective&gt;
    &lt;/not&gt;
    &lt;time&gt;5s&lt;/time&gt;
&lt;/all&gt;

&lt;portal yaw="@0" sound="false"&gt;
    &lt;forward&gt;
        &lt;all&gt;
            &lt;filter id="red-filter"/&gt;
            &lt;region id="portal-region"/&gt;
        &lt;/all&gt;
    &lt;/forward &gt;
    &lt;destination&gt;
        &lt;region id="arena1-spawn1-round1"/&gt;
    &lt;/destination&gt;
&lt;/portal&gt;
</code></pre>
<h3>Player Count Filter</h3>
<p>11:42]
        pugzy The <code>&lt;players&gt;</code> element allows you to insert <code>&lt;players min="8"/&gt;</code> (not sure of the attributes, need this clarifying) into a filter so that at least 8 players match it before it becomes true, right?
        Just writing something in the report. (edited)</p>
<p>[11:43]
        Hokay, just found this https://octc.slack.com/archives/builders/p1469490780000349 going to presume my guess was correct.</p>
<p>[11:53]
        cubist yes
        but you need to give it a filter to test the players</p>
<p>[11:54]
        pugzy Yeah, think I'm just going to use your example, makes the most sense.</p>
<p>[11:56]
        Ahh so the <code>players</code> must be the parent of the filter that is assessed, it can't be a sibling within the <code>&lt;all&gt;</code> element?</p>
<pre><code>&lt;all&gt;
    &lt;region id="..."/&gt;
    &lt;players min="3"/&gt;
&lt;/all&gt;
</code></pre>
<p>[12:02]
        cubist right
        you can also do <code>&lt;players filter="id"/&gt;</code></p>
<h3>Applying Kits</h3>
<p>Kits where given to player by using a separate <code>&lt;apply&gt;</code> element, there is now a much cleaner way.
        The kit can directly specify when and where it will be given or taken by using its <code>give</code>, <code>take</code> or <code>lend</code> properties.</p>
<p>Instead of doing:</p>
<pre><code>&lt;kit id="tower-kit"&gt;
    &lt;item material="gold sword"/&gt;
&lt;/kit&gt;

&lt;apply kit="tower-kit"&gt;
    &lt;!-- filters, regions, etc. --&gt;
    &lt;region id="tower-region"/&gt;
&lt;/apply&gt;
</code></pre>
<p>You should now do the following:</p>
<pre><code>&lt;kit id="tower-kit"&gt;
    &lt;item material="gold sword"/&gt;
    &lt;give&gt;
        &lt;!-- filters, regions, etc. --&gt;
        &lt;region id="tower-region"/&gt;
    &lt;/give&gt;
&lt;/kit&gt;
</code></pre>
<hr/>
<pre><code>[14:40]
cubist ... we will deprecate a few things since there are better ways to do them now, like using `&lt;apply&gt;` with kits

[14:43]
yoyo_ What would be the better way to do that now?

[14:43]
cubist `&lt;kit give="..."`
</code></pre>

